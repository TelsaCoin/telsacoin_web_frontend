<div class="container">
    <div class="userprofile-section" *ngIf="userDetails">
        <div class="d-flex w100 row">
            <div class="user-image">
                <div>
                    <div class="user-image-avatar" *ngIf="!userDetails.img">
                        <span *ngIf="!isImageUploading">{{getAvatarText(userDetails?.fullname)}}</span>
                        <span *ngIf="isImageUploading"><i class="fas fa-spinner fa-spin" aria-hidden="true"></i></span>
                    </div>
                    <div *ngIf="userDetails.img">
                        <img [src]="userDetails.img">
                    </div>
                </div>
                <div class="edit-icon">
                    <input type="file" (change)="onFileChanged($event)" style="display: none" #fileInput>
                    <mat-icon (click)="fileInput.click()">edit</mat-icon>
                </div>
            </div>
            <div class="user-details" *ngIf="!isProfileFormOpen">
                <h2>{{userDetails?.fullname}}</h2>
                <p class="text-truncate" [innerHTML]="userDetails?.settings?.Account?.Bio"></p>
            </div>
            <div class="the-form" *ngIf="isProfileFormOpen">

                <form [formGroup]="profileForm" (ngSubmit)="onSubmit(profileForm.value)" class="form">
                    <mat-form-field class="form-element">
                        <input matInput placeholder="Full Name" formControlName="fullname">
                        <mat-error
                            *ngIf="!profileForm.controls['fullname'].valid && profileForm.controls['fullname'].touched">
                            {{ getErrorFullname(profileForm) }}
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field class="form-element">
                        <textarea matInput placeholder="Bio" formControlName="bio"></textarea>
                    </mat-form-field>
                    <div class="form-element">
                        <button mat-raised-button color="primary" type="submit" class="button"
                            [disabled]="!profileForm.valid || isImageUploading">Edit<i class="fas fa-spinner fa-spin"
                                *ngIf="isImageUploading" aria-hidden="true"></i></button>
                    </div>
                </form>
            </div>
        </div>
        <div>
            <div class="edit-all-icon" (click)="isProfileFormOpen = !isProfileFormOpen">
                <mat-icon *ngIf="!isProfileFormOpen">edit</mat-icon>
                <mat-icon *ngIf="isProfileFormOpen">close</mat-icon>
            </div>
        </div>
    </div>
    <div class="userprofile-section" *ngIf="unclaimedText">
        <div class="d-flex justify-content-between align-items-center w100 row" style="padding:15px;">
            <h3>{{unclaimedText}}</h3>
            <button mat-raised-button color="primary" (click)="claimRewards()">Redeem Rewards(Transfer To
                Balance)</button>
        </div>
    </div>
    <div class="userpodcasts-section">
        <mat-tab-group style="margin-bottom: 20px;" [(selectedIndex)]="index">
            <mat-tab label="Podcasts">
                <div>
                    <div *ngFor="let podcast of podcasts; let podcastIndex = index;">
                        <div *ngFor="let episode of podcast.Episodes; let episodeIndex = index;" class="the-episodes">
                            <app-podcast-card [episodeData]="episode" showUpvote="false" class="w100">
                            </app-podcast-card>
                            <div class="d-flex flex-column justify-content-around" style="padding-right: 20px;">
                                <div class="status" (click)="triggerHive(episode)">
                                    {{episode.hive_status == 'invalid' ? 'Not published' : episode.hive_status}}
                                </div>
                                <div (click)="redirectToEmbed(episode.id)">
                                    <button mat-raised-button color="primary">Embed a Badge</button>
                                </div>
                                <div (click)="openCommentDialog(episode.id)">
                                    <button mat-raised-button color="primary">Add Community</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </mat-tab>
            <mat-tab label="Communities">
                <mat-tab-group *ngIf="index == 1" [selectedIndex]="1" style="margin-bottom: 20px;">
                    <mat-tab label="All Communities">
                        <div *ngIf="!isCommunityLoaded">
                            <div *ngFor="let loaderNum of [0,1,2,3,4,5,6,7,8,9]">
                                <div class="timeline-wrapper">
                                    <div class="timeline-item">
                                        <div class="animated-background">
                                            <div class="vertical-bottom"></div>
                                            <div class="horizontal-bottom"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="isCommunityLoaded">
                            <div *ngFor="let community of allCommunity" class="community-card">
                                <div class="d-flex">
                                    <img [src]="community.profileImageUrl"
                                        default="https://aurealbucket.s3.us-east-2.amazonaws.com/Thumbnail.png">
                                    <div>
                                        <h6 class="name">{{community.name}}</h6>
                                        <p class="author text-truncate">{{community.description}}</p>
                                    </div>
                                </div>
                                <div>
                                    <button mat-raised-button color="primary"
                                        (click)="followCommunity(community)">Follow</button>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <mat-tab label="Created Communities">
                        <div *ngIf="!isCommunityLoaded">
                            <div *ngFor="let loaderNum of [0,1,2,3,4,5,6,7,8,9]">
                                <div class="timeline-wrapper">
                                    <div class="timeline-item">
                                        <div class="animated-background">
                                            <div class="vertical-bottom"></div>
                                            <div class="horizontal-bottom"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="isCommunityLoaded">
                            <div *ngFor="let community of allCreatedCommunity" class="community-card">
                                <div class="d-flex">
                                    <img [src]="community.profileImageUrl"
                                        default="https://aurealbucket.s3.us-east-2.amazonaws.com/Thumbnail.png">
                                    <div>
                                        <h6 class="name">{{community.name}}</h6>
                                        <p class="author text-truncate">{{community.description}}</p>
                                    </div>
                                </div>
                                <div>
                                    <button mat-raised-button color="primary"
                                        (click)="followCommunity(community)">Follow</button>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                    <mat-tab label="Followed Communities">
                        <div *ngIf="!allFollowedCommunity">
                            <div *ngFor="let loaderNum of [0,1,2,3,4,5,6,7,8,9]">
                                <div class="timeline-wrapper">
                                    <div class="timeline-item">
                                        <div class="animated-background">
                                            <div class="vertical-bottom"></div>
                                            <div class="horizontal-bottom"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="allFollowedCommunity">
                            <div *ngFor="let community of allFollowedCommunity" class="community-card">
                                <div class="d-flex">
                                    <img [src]="community.profileImageUrl"
                                        default="https://aurealbucket.s3.us-east-2.amazonaws.com/Thumbnail.png">
                                    <div>
                                        <h6 class="name">{{community.name}}</h6>
                                        <p class="author text-truncate">{{community.description}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </mat-tab>
                </mat-tab-group>


            </mat-tab>
        </mat-tab-group>

        <div *ngIf="currentTab == 'Communities'">


        </div>
    </div>


</div>